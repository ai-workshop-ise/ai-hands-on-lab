

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Content with notebooks &#8212; AI Workshop</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notebooks with MyST Markdown" href="markdown-notebooks.html" />
    <link rel="prev" title="Markdown Files" href="markdown.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="AI Workshop - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="AI Workshop - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your AI Hands-On Workshop
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">Retrieval Augmented Generation (RAG)</a></li>
<li class="toctree-l1"><a class="reference internal" href="aisearch.html">Vector search in Azure AI Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison.html">Comparison of existing Azure Studios</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/notebooks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Content with notebooks</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#markdown-notebooks">Markdown + notebooks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#myst-markdown">MyST markdown</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-blocks-and-outputs">Code blocks and outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-phi2-from-aml">Use phi2 from AML</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="content-with-notebooks">
<h1>Content with notebooks<a class="headerlink" href="#content-with-notebooks" title="Permalink to this heading">#</a></h1>
<p>You can also create content with Jupyter Notebooks. This means that you can include
code blocks and their outputs in your book.</p>
<section id="markdown-notebooks">
<h2>Markdown + notebooks<a class="headerlink" href="#markdown-notebooks" title="Permalink to this heading">#</a></h2>
<p>As it is markdown, you can embed images, HTML, etc into your posts!</p>
<p><img alt="" src="https://myst-parser.readthedocs.io/en/latest/_static/logo-wide.svg" /></p>
<p>You can also <span class="math notranslate nohighlight">\(add_{math}\)</span> and</p>
<div class="math notranslate nohighlight">
\[
math^{blocks}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\mbox{mean} la_{tex} \\ \\
math blocks
\end{aligned}
\end{split}\]</div>
<p>But make sure you $Escape $your $dollar signs $you want to keep!</p>
</section>
<section id="myst-markdown">
<h2>MyST markdown<a class="headerlink" href="#myst-markdown" title="Permalink to this heading">#</a></h2>
<p>MyST markdown works in Jupyter Notebooks as well. For more information about MyST markdown, check
out <a class="reference external" href="https://jupyterbook.org/content/myst.html">the MyST guide in Jupyter Book</a>,
or see <a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/">the MyST markdown documentation</a>.</p>
</section>
<section id="code-blocks-and-outputs">
<h2>Code blocks and outputs<a class="headerlink" href="#code-blocks-and-outputs" title="Permalink to this heading">#</a></h2>
<p>Jupyter Book will also embed your code blocks and output in your book.
For example, hereâ€™s some sample Matplotlib code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span><span class="p">,</span> <span class="n">cycler</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;contextlib.ExitStack at 0x18276c00110&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fixing random state for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">19680801</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="n">ii</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cycler</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)))</span>


<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
<span class="n">custom_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
                <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mf">.5</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
                <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">custom_lines</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Cold&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Hot&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a7a52b22adf7fc94d44d4ae8c80684960d682f2a33981e38e32f12000c519272.png" src="_images/a7a52b22adf7fc94d44d4ae8c80684960d682f2a33981e38e32f12000c519272.png" />
</div>
</div>
<p>There is a lot more that you can do with outputs (such as including interactive outputs)
with your book. For more information about this, see <a class="reference external" href="https://jupyterbook.org">the Jupyter Book documentation</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openai</span> <span class="kn">import</span> <span class="n">AzureOpenAI</span>
<span class="kn">from</span> <span class="nn">azure.identity</span> <span class="kn">import</span> <span class="n">DefaultAzureCredential</span><span class="p">,</span> <span class="n">get_bearer_token_provider</span>

<span class="n">token_provider</span> <span class="o">=</span> <span class="n">get_bearer_token_provider</span><span class="p">(</span><span class="n">DefaultAzureCredential</span><span class="p">(),</span> <span class="s2">&quot;https://cognitiveservices.azure.com/.default&quot;</span><span class="p">)</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">AzureOpenAI</span><span class="p">(</span><span class="n">api_version</span><span class="o">=</span><span class="s2">&quot;2023-07-01-preview&quot;</span><span class="p">,</span> 
                     <span class="n">azure_endpoint</span><span class="o">=</span><span class="s2">&quot;https://openai-adina.openai.azure.com/&quot;</span><span class="p">,</span>
                     <span class="n">azure_ad_token_provider</span><span class="o">=</span><span class="n">token_provider</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">embeddings</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">embeddings</span>
<span class="n">embeddings</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.0017071267357096076,
 -0.01391641329973936,
 0.0017036213539540768,
 -0.018410328775644302,
 -0.007154508493840694,
 0.01852250099182129,
 -0.00961179006844759,
 -0.0291648767888546,
 -0.00613093376159668,
 -0.014722653664648533,
 0.011820187792181969,
 0.007168530020862818,
 0.001400404842570424,
 -0.011764101684093475,
 -0.007151003461331129,
 0.01304707583039999,
 0.04686010256409645,
 0.0009350638138130307,
 0.01702219247817993,
 -0.028716186061501503,
 0.010663407854735851,
 0.007277197670191526,
 -0.00323723116889596,
 0.00153273344039917,
 -0.03017442859709263,
 -0.014834826812148094,
 0.0017982670105993748,
 -0.03704500198364258,
 -0.00310753146186471,
 0.0028744228184223175,
 0.01891510561108589,
 -0.028884444385766983,
 -0.02673914283514023,
 -0.02986595407128334,
 -0.023373965173959732,
 -0.008384902030229568,
 -0.003933051601052284,
 -0.013965488411486149,
 0.01787750795483589,
 -6.92862959112972e-05,
 0.010432051494717598,
 0.013341528363525867,
 0.005492952186614275,
 -0.014554395340383053,
 -0.00323723116889596,
 -0.00848305318504572,
 0.012044533155858517,
 -0.028365645557641983,
 -0.022350391373038292,
 0.01716240867972374,
 0.010915796272456646,
 0.007014292757958174,
 -0.012570342049002647,
 -0.01029884722083807,
 -0.01268952526152134,
 0.000987644656561315,
 -0.00866533350199461,
 0.002541410503908992,
 0.013783208094537258,
 -0.014540373347699642,
 -0.026346540078520775,
 -0.007179046515375376,
 -0.012465179897844791,
 0.024103088304400444,
 0.01142758410423994,
 -0.007368337828665972,
 0.005647189449518919,
 0.012808708474040031,
 0.008693376556038857,
 0.006611172575503588,
 0.023598311468958855,
 0.013222345151007175,
 -0.001206731772981584,
 0.011357476003468037,
 0.029417265206575394,
 -0.006397343706339598,
 -0.006018761079758406,
 -0.0123459966853261,
 -0.014554395340383053,
 0.013881359249353409,
 0.025659482926130295,
 -0.013706089928746223,
 -0.020163025707006454,
 0.002946283435449004,
 0.01615285500884056,
 0.008462020196020603,
 0.00035798834869638085,
 0.01936379447579384,
 -0.006961712148040533,
 0.00103058572858572,
 -0.0007501542568206787,
 0.01389538124203682,
 0.006155471317470074,
 0.00729121919721365,
 -0.01869075931608677,
 -0.006148460786789656,
 0.004500925540924072,
 0.03471741825342178,
 -0.019644226878881454,
 -0.03264222666621208,
 -0.005748845636844635,
 -0.008735441602766514,
 0.014792761765420437,
 -0.018802931532263756,
 -0.00919114239513874,
 0.00492858374491334,
 -0.002241699257865548,
 -0.001314522698521614,
 0.02403298020362854,
 0.00703181978315115,
 -0.03426872938871384,
 0.03586718812584877,
 -0.007010787725448608,
 -0.022785060107707977,
 0.007133476436138153,
 0.0015441259602084756,
 -0.00655859149992466,
 -0.02369646169245243,
 0.0013504528906196356,
 -0.001227764179930091,
 0.028407711535692215,
 0.001128736766986549,
 0.027412179857492447,
 -0.01754099130630493,
 0.012661482207477093,
 0.012009479105472565,
 -0.012997999787330627,
 -0.029893998056650162,
 -0.0009587251697666943,
 0.011182205751538277,
 0.031464412808418274,
 0.01012357696890831,
 0.022925274446606636,
 -0.001434582401998341,
 -0.022013872861862183,
 0.008693376556038857,
 -0.03247396647930145,
 0.024117108434438705,
 -0.039568886160850525,
 -0.015507861971855164,
 0.0028411217499524355,
 0.0322776660323143,
 -0.011820187792181969,
 -0.006593645550310612,
 -0.011715025641024113,
 0.015283516608178616,
 0.032502010464668274,
 0.005780394189059734,
 -0.0006116912118159235,
 -0.023738525807857513,
 0.008560171350836754,
 -0.010432051494717598,
 0.011848230846226215,
 0.008980819024145603,
 -0.00850408524274826,
 0.019966723397374153,
 0.004434322938323021,
 -0.010235750116407871,
 -0.01553590502589941,
 -0.0019314719829708338,
 0.007557629141956568,
 0.012226813472807407,
 0.0038349006790667772,
 -0.01989661529660225,
 0.00441329088062048,
 0.029978128150105476,
 0.0003211816947441548,
 0.008686365559697151,
 -0.0054123280569911,
 -0.018662717193365097,
 -0.012556320056319237,
 0.021382901817560196,
 -0.04010170325636864,
 0.02713174745440483,
 0.010326890274882317,
 0.01754099130630493,
 -0.0074734995141625404,
 0.013853316195309162,
 -0.00996232870966196,
 -0.008861635811626911,
 -0.016222963109612465,
 0.019644226878881454,
 0.03401634097099304,
 0.02849183976650238,
 -3.9271362766157836e-05,
 -0.018059788271784782,
 0.009871188551187515,
 -0.009015873074531555,
 0.004287096671760082,
 -0.025631438940763474,
 0.019672269001603127,
 0.016363177448511124,
 0.00462711974978447,
 -0.003573748981580138,
 -0.69322669506073,
 0.009674887172877789,
 0.007042336277663708,
 -0.0035807597450912,
 0.032333750277757645,
 0.038026511669158936,
 0.04887920990586281,
 0.01090878527611494,
 -0.03213744983077049,
 0.004010170232504606,
 0.005177466664463282,
 0.014070650562644005,
 -0.01012357696890831,
 -0.014386136084794998,
 -0.007480510510504246,
 0.006295687053352594,
 0.011602853424847126,
 -0.023275814950466156,
 0.0005849626031704247,
 0.026907403022050858,
 -0.014512330293655396,
 0.014568416401743889,
 0.008532128296792507,
 0.012668493203818798,
 -0.003302081022411585,
 -0.0001402157504344359,
 -0.002275000559166074,
 -0.013888370245695114,
 0.003659631125628948,
 -0.010684439912438393,
 -0.023906785994768143,
 0.010838677175343037,
 0.0142599418759346,
 0.006285171024501324,
 0.03410046920180321,
 -0.015718186274170876,
 -0.017737291753292084,
 0.007151003461331129,
 9.037343261297792e-05,
 0.035951320081949234,
 -0.009071959182620049,
 -0.007936211302876472,
 0.030987679958343506,
 0.018844997510313988,
 0.002962057711556554,
 0.013243377208709717,
 0.006292182020843029,
 -2.3812030121916905e-05,
 -0.0018753856420516968,
 -0.004374731332063675,
 0.0012137425364926457,
 -0.0011480164248496294,
 -0.012563331052660942,
 0.005556049291044474,
 -0.0045850551687181,
 -0.012065565213561058,
 0.013790219090878963,
 -0.010656396858394146,
 -0.000693629786837846,
 0.005202004220336676,
 -0.008090448565781116,
 -0.0011786886025220156,
 -0.008412945084273815,
 -0.00883359182626009,
 -0.041447777301073074,
 0.017723271623253822,
 -0.01751294732093811,
 0.025799697265028954,
 0.00411182688549161,
 -0.004879508167505264,
 -0.003726233495399356,
 -0.0031969191040843725,
 -0.016419263556599617,
 -0.01064237579703331,
 0.017611097544431686,
 0.031155940145254135,
 0.021831592544913292,
 -0.007795995566993952,
 -0.003296822775155306,
 0.005198498722165823,
 -0.0008263965719379485,
 0.0005091584171168506,
 -0.008735441602766514,
 0.005980201531201601,
 0.0316326729953289,
 -0.004802389536052942,
 -0.007480510510504246,
 -0.0073262727819383144,
 0.01595655269920826,
 0.01417581271380186,
 0.025519266724586487,
 0.017288602888584137,
 0.003855933202430606,
 -0.0035492111928761005,
 0.016054702922701836,
 0.004402774386107922,
 0.001369732664898038,
 0.005878545343875885,
 0.02504253387451172,
 -0.011462637223303318,
 0.0007260546553879976,
 -0.0006296563660725951,
 0.001141882035881281,
 -0.004655162803828716,
 -0.006930163595825434,
 0.0120865972712636,
 0.00668829120695591,
 0.028968574479222298,
 0.024944381788372993,
 -0.008917721919715405,
 -0.01906934194266796,
 -0.01536764670163393,
 -0.005980201531201601,
 -0.008966797031462193,
 0.0006822372670285404,
 -0.040073662996292114,
 0.006316719576716423,
 0.014498308300971985,
 0.014358093030750751,
 -0.019335752353072166,
 0.013348539359867573,
 0.007760941982269287,
 0.020149003714323044,
 0.0023766569793224335,
 -0.0021014835219830275,
 0.009212174452841282,
 -0.01303305383771658,
 -0.017050234600901604,
 -0.01682589016854763,
 -0.020836060866713524,
 0.006116912234574556,
 -0.013727121986448765,
 0.010165642015635967,
 -0.031464412808418274,
 0.00933836866170168,
 -0.004395763855427504,
 0.02490231767296791,
 -0.021873656660318375,
 0.013404625467956066,
 -0.02623436599969864,
 -0.003754276782274246,
 -0.003589523257687688,
 0.009289293549954891,
 0.0125422989949584,
 0.011238292790949345,
 -0.020723888650536537,
 -0.019602162763476372,
 -0.013692067936062813,
 -0.011476659215986729,
 0.020723888650536537,
 -0.017975660040974617,
 -0.005023229401558638,
 -0.022714952006936073,
 -0.0023556246887892485,
 -0.002753486856818199,
 -0.03003421425819397,
 -0.002154064364731312,
 -0.022378433495759964,
 -0.01871880330145359,
 -0.009001851081848145,
 -0.00111646787263453,
 0.02728598564863205,
 -0.014961021021008492,
 0.0011786886025220156,
 -0.007494532037526369,
 0.000991150038316846,
 -0.020906168967485428,
 0.013264410197734833,
 -0.0037122119683772326,
 -0.025140684098005295,
 -0.009927275590598583,
 -0.002970821224153042,
 -0.003989138174802065,
 0.024131130427122116,
 0.004024192225188017,
 0.00823767576366663,
 0.0006690920563414693,
 -0.008209631778299809,
 0.0038699547294527292,
 -0.022448541596531868,
 0.008553160354495049,
 0.011532745324075222,
 -0.003426522482186556,
 0.006677775178104639,
 0.023766569793224335,
 0.0174989253282547,
 0.010691450908780098,
 0.010354933328926563,
 -0.010516181588172913,
 0.008700387552380562,
 -0.01594253070652485,
 -0.008707398548722267,
 -0.00816055666655302,
 0.005836480762809515,
 -0.0017334171570837498,
 0.011967414058744907,
 0.006789947859942913,
 0.0014652545796707273,
 0.008048384450376034,
 0.008384902030229568,
 0.024341454729437828,
 -0.0074384454637765884,
 -0.005089831538498402,
 -0.0011357475304976106,
 0.021242685616016388,
 -0.02281310223042965,
 0.00969591923058033,
 -0.014638524502515793,
 0.007080895360559225,
 0.01937781646847725,
 0.009303314611315727,
 -0.042962104082107544,
 -0.027846848592162132,
 -0.006369300652295351,
 0.02592589147388935,
 0.021144535392522812,
 -0.00390851404517889,
 0.00035207299515604973,
 -0.008258707821369171,
 0.006667259149253368,
 0.010551235638558865,
 -0.009366411715745926,
 -0.0037928360980004072,
 -0.010572267696261406,
 -0.003515909891575575,
 0.0036140610463917255,
 0.014484287239611149,
 0.04105517268180847,
 0.021873656660318375,
 -0.03020247258245945,
 -0.01817196048796177,
 0.01682589016854763,
 0.010411019437015057,
 -0.00016924479859881103,
 0.020695844665169716,
 0.010733515955507755,
 0.010130587965250015,
 -0.024593843147158623,
 0.03909214958548546,
 0.019307708367705345,
 0.012878816574811935,
 0.01149068120867014,
 0.0333152636885643,
 -0.003082993905991316,
 0.019475968554615974,
 0.002289022086188197,
 0.03210940584540367,
 -0.0001290423097088933,
 -0.009822113439440727,
 0.00789414718747139,
 -0.0021365375723689795,
 0.010516181588172913,
 0.0008627650677226484,
 -0.013544841669499874,
 0.03348352015018463,
 -0.011013947427272797,
 -0.011175195686519146,
 0.018059788271784782,
 0.021368879824876785,
 0.04800987243652344,
 0.017106320708990097,
 0.00968189723789692,
 -0.0005761990905739367,
 -0.0014608728233724833,
 0.008195610716938972,
 -0.005962674971669912,
 0.010032436810433865,
 -0.0014827816048637033,
 0.004521958064287901,
 -0.028547925874590874,
 -0.010109555907547474,
 -0.015662100166082382,
 0.009934285655617714,
 -0.00743143493309617,
 0.018971191719174385,
 0.012857784517109394,
 0.006102890707552433,
 -0.004374731332063675,
 0.02331787906587124,
 -0.011133130639791489,
 -0.003470339812338352,
 -0.03300678730010986,
 0.02180354855954647,
 0.0020506554283201694,
 0.007564639672636986,
 -0.02023313194513321,
 -0.03415655717253685,
 0.003328371327370405,
 -0.002991853514686227,
 -0.00024231034331023693,
 -0.017470883205533028,
 -0.02282712422311306,
 0.019616182893514633,
 -0.019812485203146935,
 0.01389538124203682,
 0.022434519603848457,
 0.004974153824150562,
 0.001623873715288937,
 0.00031263730488717556,
 -0.003419511718675494,
 0.005952158477157354,
 -0.002141795586794615,
 -0.006250116974115372,
 -0.022939296439290047,
 0.00822365377098322,
 -0.008132513612508774,
 -0.02300940454006195,
 -0.0212567076086998,
 0.014168801717460155,
 -0.002129526808857918,
 0.013923424296081066,
 -0.010060479864478111,
 -0.017176428809762,
 0.001266323495656252,
 0.00614144979044795,
 0.00926826149225235,
 -0.019980743527412415,
 0.0020331284031271935,
 0.02265886589884758,
 0.011041990481317043,
 -0.027187833562493324,
 -0.021018341183662415,
 -0.02211202308535576,
 0.0015528894728049636,
 0.028043150901794434,
 0.02885640226304531,
 0.01598459482192993,
 0.020485520362854004,
 -0.009906242601573467,
 -0.011553777381777763,
 -0.023752547800540924,
 -0.02027519792318344,
 0.009920264594256878,
 -0.010873731225728989,
 0.0054438766092062,
 -0.0029392726719379425,
 0.008616257458925247,
 -0.0174989253282547,
 0.006779431365430355,
 0.024635907262563705,
 -0.001515206415206194,
 -0.008609247393906116,
 0.013839294202625751,
 0.006144955288618803,
 -0.011736058630049229,
 0.005075810011476278,
 0.013404625467956066,
 0.01536764670163393,
 0.008251696825027466,
 -0.000607747642789036,
 0.001730788149870932,
 0.017050234600901604,
 0.010593299753963947,
 -0.013741143979132175,
 -0.007950233295559883,
 0.015563948079943657,
 -0.008882667869329453,
 0.01733066700398922,
 0.0011620380682870746,
 0.02643066830933094,
 -0.003366930643096566,
 0.011041990481317043,
 0.009934285655617714,
 -0.010488138534128666,
 0.02523883432149887,
 0.0009201658540405333,
 0.00035207299515604973,
 -0.000759794085752219,
 -0.0016466587549075484,
 -0.0009709940641187131,
 0.01784946583211422,
 0.012317953631281853,
 -0.0024327433202415705,
 -0.024930359795689583,
 0.009506627917289734,
 0.010684439912438393,
 -0.020808016881346703,
 -0.01536764670163393,
 -0.0007992297760210931,
 0.030510947108268738,
 -0.015914488583803177,
 -0.008181588724255562,
 -0.01786348596215248,
 -0.008812559768557549,
 -0.025294922292232513,
 -0.04141973331570625,
 0.000435983354691416,
 -0.010621342808008194,
 -0.014112715609371662,
 -0.03623174875974655,
 -0.02334592305123806,
 -0.012647461146116257,
 -0.027019575238227844,
 -0.01633513532578945,
 -0.006849539466202259,
 -0.023976894095540047,
 -0.012731590308248997,
 -0.014470265246927738,
 0.024299388751387596,
 0.0071299709379673,
 0.021200621500611305,
 0.021915722638368607,
 0.003018144052475691,
 0.016391221433877945,
 -0.012920881621539593,
 0.00048374434118159115,
 -0.011785133741796017,
 -0.013811251148581505,
 0.005990718025714159,
 0.01159584242850542,
 0.0034720925614237785,
 0.000886426423676312,
 0.00023267051437869668,
 -0.006456935312598944,
 0.010754548013210297,
 0.00858120433986187,
 -0.003607050282880664,
 -0.02314962074160576,
 0.010943839326500893,
 0.004581549670547247,
 0.0023380976635962725,
 0.012402082793414593,
 -0.014890912920236588,
 -0.006733861286193132,
 0.001708879484795034,
 -0.01716240867972374,
 0.0038068576250225306,
 0.003996148705482483,
 0.004991680849343538,
 0.008686365559697151,
 -0.020527586340904236,
 0.027748696506023407,
 -0.02400493621826172,
 -0.003230220405384898,
 0.031520500779151917,
 -0.01226186752319336,
 0.013348539359867573,
 -0.005349230952560902,
 0.009057937189936638,
 0.0013373077381402254,
 -0.001477523474022746,
 0.02247658558189869,
 -0.00789414718747139,
 -0.011560788378119469,
 -0.0013986520934849977,
 -0.03138028457760811,
 0.028085215017199516,
 0.007929200306534767,
 -0.010179663076996803,
 0.0019787948112934828,
 -0.01888706162571907,
 -0.011883284896612167,
 -0.00012214106391184032,
 0.00703181978315115,
 -0.023892764002084732,
 0.021873656660318375,
 -0.014456244185566902,
 -0.006870571989566088,
 -0.039568886160850525,
 -0.02933313511312008,
 -0.027706632390618324,
 0.008265718817710876,
 0.007480510510504246,
 0.005079315509647131,
 -0.02438351884484291,
 0.010530202649533749,
 0.006986249703913927,
 -0.03600740432739258,
 0.0005805808468721807,
 -0.03645609691739082,
 -0.011974425055086613,
 0.010088522918522358,
 -0.008398923091590405,
 0.01852250099182129,
 0.00562615692615509,
 -0.01346071157604456,
 -0.03191310539841652,
 -0.009773037396371365,
 -0.012324964627623558,
 -0.04200863838195801,
 0.011343454010784626,
 -0.01988259330391884,
 0.024103088304400444,
 0.00899484008550644,
 0.03289461508393288,
 -0.0042941072024405,
 0.011988447047770023,
 0.009156088344752789,
 0.0014670073287561536,
 -0.0025782170705497265,
 -0.02094823308289051,
 0.0023468611761927605,
 -0.013306474313139915,
 0.028085215017199516,
 0.025883827358484268,
 -0.002439754083752632,
 0.009121034294366837,
 0.0074033914133906364,
 -0.0007852081907913089,
 0.017765335738658905,
 -0.009282282553613186,
 -0.006481472868472338,
 -0.008840602822601795,
 -0.006113406736403704,
 0.00297958473674953,
 0.0018911599181592464,
 -0.003985632676631212,
 0.01786348596215248,
 -0.014638524502515793,
 -0.01992465741932392,
 0.03023051656782627,
 -0.0010358438594266772,
 0.0007094040629453957,
 -0.006218568421900272,
 0.010796613059937954,
 -0.0169801265001297,
 -0.004448344465345144,
 0.009506627917289734,
 -0.0071615194901824,
 0.011736058630049229,
 -0.017442839220166206,
 -0.03393221274018288,
 -0.0020453971810638905,
 0.014126736670732498,
 -0.0016650620382279158,
 0.018452392891049385,
 -0.007270186673849821,
 0.014056628569960594,
 -0.010389987379312515,
 0.01974237710237503,
 -0.03541849926114082,
 -0.01417581271380186,
 -0.004949615802615881,
 -0.01633513532578945,
 -0.005457898136228323,
 -0.005226542241871357,
 0.02160724624991417,
 -0.010607321746647358,
 0.018788911402225494,
 0.011294378899037838,
 -0.02779076248407364,
 0.004953121300786734,
 -0.013600927777588367,
 -0.017036214470863342,
 -0.006527043413370848,
 -0.009485595859587193,
 0.029220962896943092,
 0.022266261279582977,
 0.019518032670021057,
 0.03278244286775589,
 -0.001722024637274444,
 -0.03297874331474304,
 -0.020471500232815742,
 -0.007859093137085438,
 -0.019335752353072166,
 0.03244592621922493,
 0.019504010677337646,
 -0.007915179245173931,
 -0.004371225833892822,
 0.017779357731342316,
 0.02403298020362854,
 -0.0051529286429286,
 -0.011462637223303318,
 -0.0035106518771499395,
 0.02059769444167614,
 0.0018596113659441471,
 -0.021509096026420593,
 -0.0023380976635962725,
 -0.046411413699388504,
 0.019994765520095825,
 0.0009937791619449854,
 -0.010144609957933426,
 -0.01803174614906311,
 -0.002047149930149317,
 -0.0002983966551255435,
 0.008532128296792507,
 -0.02952943742275238,
 0.016685673967003822,
 0.01905531994998455,
 -0.03104376792907715,
 0.005629662424325943,
 -0.0010726505424827337,
 -0.020667800679802895,
 0.00339322118088603,
 -0.007943222299218178,
 0.03687674179673195,
 -0.016713717952370644,
 0.004904045723378658,
 0.0285198837518692,
 -0.002381914993748069,
 -0.016713717952370644,
 0.0015169591642916203,
 -0.015591991133987904,
 0.030426817014813423,
 -0.032333750277757645,
 0.004995185881853104,
 -0.003503641113638878,
 0.01236702874302864,
 0.006064331158995628,
 0.015381667762994766,
 -0.02422928251326084,
 -0.017723271623253822,
 -0.010761559009552002,
 -0.0006103767082095146,
 0.02247658558189869,
 0.008854624815285206,
 0.006768915336579084,
 -0.011806165799498558,
 -0.010474116541445255,
 -0.004550001118332148,
 -0.01735870912671089,
 -0.0329226590692997,
 0.0031408327631652355,
 -0.0007843318744562566,
 -0.031688760966062546,
 0.002590486081317067,
 0.0018017723923549056,
 0.001343442127108574,
 0.0021838604006916285,
 -0.018802931532263756,
 0.005724308080971241,
 0.012927892617881298,
 -0.036960870027542114,
 0.011476659215986729,
 -0.0074734995141625404,
 0.002371398964896798,
 -0.011651928536593914,
 0.005202004220336676,
 -0.015591991133987904,
 -0.015045150183141232,
 0.019181514158844948,
 -0.03348352015018463,
 -0.020541608333587646,
 -0.025126662105321884,
 -0.012745611369609833,
 0.017611097544431686,
 0.007908168248832226,
 -0.00900886207818985,
 0.003165370551869273,
 -0.012331975623965263,
 -0.001785998116247356,
 0.003989138174802065,
 -0.013699078932404518,
 0.005976696498692036,
 -0.015045150183141232,
 0.009752005338668823,
 -0.004024192225188017,
 -0.014526351355016232,
 0.01072650495916605,
 0.009036905132234097,
 0.016881976276636124,
 0.00677592633292079,
 -0.017933594062924385,
 -0.005114369560033083,
 -0.005633167922496796,
 0.010901774279773235,
 -0.004995185881853104,
 -0.010158631019294262,
 -0.02936117723584175,
 -0.0028533905278891325,
 0.003370436141267419,
 0.01581633649766445,
 0.0008837974164634943,
 -0.011764101684093475,
 -0.0033178552985191345,
 -0.013061096891760826,
 0.0004780480812769383,
 0.018957169726490974,
 -0.013194302096962929,
 0.003039176343008876,
 -0.028772272169589996,
 -0.000585838919505477,
 -0.015185365453362465,
 -0.011623885482549667,
 0.004262558650225401,
 0.026514798402786255,
 0.005331703927367926,
 -0.02211202308535576,
 -0.02659892849624157,
 0.007571650668978691,
 -0.05933930724859238,
 -0.021354859694838524,
 -0.002504603937268257,
 0.01958814077079296,
 0.01564807817339897,
 0.0019437408773228526,
 -0.017274580895900726,
 0.021340837702155113,
 0.016531437635421753,
 0.03037073090672493,
 -0.014442222192883492,
 -0.012058554217219353,
 0.013748154044151306,
 -0.020106937736272812,
 0.010936828330159187,
 -0.009752005338668823,
 -0.037129130214452744,
 -0.005952158477157354,
 0.01954607479274273,
 0.02727196365594864,
 0.013579895719885826,
 0.007838060148060322,
 -0.005517489742487669,
 -0.010579278692603111,
 -0.0001513891911599785,
 0.011722036637365818,
 0.00995531864464283,
 -0.026346540078520775,
 -0.008966797031462193,
 -0.008980819024145603,
 -0.01123128179460764,
 0.012402082793414593,
 -0.006888098549097776,
 -0.01391641329973936,
 -0.02250462770462036,
 -0.002476560650393367,
 -0.009716951288282871,
 0.012409093789756298,
 -0.04237319901585579,
 0.0005954787484370172,
 -0.01149769127368927,
 -0.02249060571193695,
 0.011392530053853989,
 0.008125502616167068,
 0.010375965386629105,
 0.031099854037165642,
 0.01098590437322855,
 -0.014091682620346546,
 -0.012317953631281853,
 0.00626063346862793,
 -0.019686290994286537,
 -0.006488483864814043,
 -0.003985632676631212,
 -0.011049001477658749,
 -0.022238217294216156,
 -0.012815719470381737,
 0.006639215629547834,
 -0.010852699168026447,
 0.002339850412681699,
 -0.018298154696822166,
 -0.005629662424325943,
 0.005422844085842371,
 0.01923760026693344,
 0.017611097544431686,
 -0.02662697061896324,
 -6.824563752161339e-05,
 -0.02059769444167614,
 -0.011091065593063831,
 0.00737534835934639,
 -0.012044533155858517,
 0.011609864421188831,
 -0.005924115423113108,
 0.010011404752731323,
 0.010116565972566605,
 -0.0026045076083391905,
 -0.013082129880785942,
 -0.027580438181757927,
 0.012233824469149113,
 -0.010740526020526886,
 0.01346071157604456,
 0.2016863375902176,
 9.360496915178373e-05,
 -0.006726850755512714,
 0.024411562830209732,
 0.008027351461350918,
 7.251783245010301e-05,
 0.009639833122491837,
 0.012598385103046894,
 0.001279468764550984,
 0.021747462451457977,
 0.02556133083999157,
 0.007115949410945177,
 0.004441333934664726,
 0.01105601154267788,
 0.0036736526526510715,
 0.01702219247817993,
 -0.02331787906587124,
 -0.027496308088302612,
 0.0015432495856657624,
 -0.020850082859396935,
 0.014224887825548649,
 -0.02453775703907013,
 -0.0010270803468301892,
 0.00034966302337124944,
 0.04742096737027168,
 0.004844454117119312,
 -0.009282282553613186,
 0.0011366239050403237,
 0.028940530493855476,
 -0.012955935671925545,
 -0.029809867963194847,
 -0.001309264567680657,
 0.0022311832290142775,
 -0.003515909891575575,
 -0.020709866657853127,
 -0.00840593408793211,
 -0.0008627650677226484,
 0.019644226878881454,
 0.01714838668704033,
 -0.01236702874302864,
 0.007445456460118294,
 -0.005889061372727156,
 0.013811251148581505,
 -0.01545177586376667,
 0.00039632857078686357,
 0.01629306934773922,
 ...]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">get_embeding</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">embeddings</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding</span>

<span class="k">def</span> <span class="nf">cosine_sim</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

<span class="n">sentences1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;The new movie is awesome&#39;</span><span class="p">,</span>
              <span class="s1">&#39;The new movie is awesome&#39;</span><span class="p">,</span>
              <span class="s1">&#39;The new movie is awesome&#39;</span><span class="p">]</span>

<span class="n">sentences2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;The dog plays in the garden&#39;</span><span class="p">,</span>
              <span class="s1">&#39;This recent movie is so good&#39;</span><span class="p">,</span>
              <span class="s1">&#39;The new movie is awesome&#39;</span><span class="p">]</span>

<span class="n">embeddings1</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_embeding</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sentences1</span><span class="p">]</span>
<span class="n">embeddings2</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_embeding</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sentences2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sentences1</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2"> Score: </span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sentences1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sentences2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cosine_sim</span><span class="p">(</span><span class="n">embeddings1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">embeddings2</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The new movie is awesome 		 The dog plays in the garden 		 Score: 0.7488
The new movie is awesome 		 This recent movie is so good 		 Score: 0.9191
The new movie is awesome 		 The new movie is awesome 		 Score: 1.0000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azure.identity</span> <span class="kn">import</span> <span class="n">DefaultAzureCredential</span>

<span class="n">AZURE_SEARCH_SERVICE</span> <span class="o">=</span> <span class="s2">&quot;https://gptkb-qqdtlyqowrlw4.search.windows.net&quot;</span>
<span class="n">creds</span> <span class="o">=</span> <span class="n">DefaultAzureCredential</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Create a vector index</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azure.search.documents.indexes</span> <span class="kn">import</span> <span class="n">SearchIndexClient</span>
<span class="kn">from</span> <span class="nn">azure.search.documents.indexes.models</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">SearchIndex</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;tinyvectors&quot;</span><span class="p">,</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span>
        <span class="n">SimpleField</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">SearchFieldDataType</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">SimpleField</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">SearchFieldDataType</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="n">filterable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sortable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">SearchField</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;myVector&quot;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="n">SearchFieldDataType</span><span class="o">.</span><span class="n">Collection</span><span class="p">(</span><span class="n">SearchFieldDataType</span><span class="o">.</span><span class="n">Single</span><span class="p">),</span>
                    <span class="n">searchable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">vector_search_dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                    <span class="n">vector_search_profile</span><span class="o">=</span><span class="s2">&quot;vprofile&quot;</span>                    <span class="p">)</span>
    <span class="p">],</span>
<span class="n">vector_search</span><span class="o">=</span><span class="n">VectorSearch</span><span class="p">(</span>
    <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="n">HnswAlgorithmConfiguration</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;algo&quot;</span><span class="p">,</span>
                                           <span class="n">parameters</span><span class="o">=</span><span class="n">HnswParameters</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span><span class="p">))],</span>
    <span class="n">profiles</span><span class="o">=</span><span class="p">[</span><span class="n">VectorSearchProfile</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;vprofile&quot;</span><span class="p">,</span> <span class="n">algorithm_configuration_name</span><span class="o">=</span><span class="s2">&quot;algo&quot;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="p">)</span>

<span class="n">index_client</span> <span class="o">=</span> <span class="n">SearchIndexClient</span><span class="p">(</span><span class="n">AZURE_SEARCH_SERVICE</span><span class="p">,</span> <span class="n">credential</span><span class="o">=</span><span class="n">creds</span><span class="p">)</span>
<span class="n">index_client</span><span class="o">.</span><span class="n">create_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vector_search_profile is not a known attribute of class &lt;class &#39;azure.search.documents.indexes.models._index.SearchField&#39;&gt; and will be ignored
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">16</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">azure.search.documents.indexes</span> <span class="kn">import</span> <span class="n">SearchIndexClient</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">azure.search.documents.indexes.models</span> <span class="kn">import</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">index</span> <span class="o">=</span> <span class="n">SearchIndex</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">name</span><span class="o">=</span><span class="s2">&quot;tinyvectors&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">fields</span><span class="o">=</span><span class="p">[</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>         <span class="n">SimpleField</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">SearchFieldDataType</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>         <span class="n">SimpleField</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">SearchFieldDataType</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="n">filterable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sortable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>         <span class="n">SearchField</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;myVector&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>                     <span class="nb">type</span><span class="o">=</span><span class="n">SearchFieldDataType</span><span class="o">.</span><span class="n">Collection</span><span class="p">(</span><span class="n">SearchFieldDataType</span><span class="o">.</span><span class="n">Single</span><span class="p">),</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>                     <span class="n">searchable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>                     <span class="n">vector_search_dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>                     <span class="n">vector_search_profile</span><span class="o">=</span><span class="s2">&quot;vprofile&quot;</span>                    <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>     <span class="p">],</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="n">vector_search</span><span class="o">=</span><span class="n">VectorSearch</span><span class="p">(</span>
<span class="ne">---&gt; </span><span class="mi">16</span>     <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="n">HnswAlgorithmConfiguration</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;algo&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span>                                            <span class="n">parameters</span><span class="o">=</span><span class="n">HnswParameters</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span><span class="p">))],</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>     <span class="n">profiles</span><span class="o">=</span><span class="p">[</span><span class="n">VectorSearchProfile</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;vprofile&quot;</span><span class="p">,</span> <span class="n">algorithm_configuration_name</span><span class="o">=</span><span class="s2">&quot;algo&quot;</span><span class="p">)]</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span> <span class="n">index_client</span> <span class="o">=</span> <span class="n">SearchIndexClient</span><span class="p">(</span><span class="n">AZURE_SEARCH_SERVICE</span><span class="p">,</span> <span class="n">credential</span><span class="o">=</span><span class="n">creds</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span> <span class="n">index_client</span><span class="o">.</span><span class="n">create_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;HnswAlgorithmConfiguration&#39; is not defined
</pre></div>
</div>
</div>
</div>
<section id="use-phi2-from-aml">
<h3>Use phi2 from AML<a class="headerlink" href="#use-phi2-from-aml" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Setup model registry</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azure.ai.ml</span> <span class="kn">import</span> <span class="n">MLClient</span>
<span class="kn">from</span> <span class="nn">azure.identity</span> <span class="kn">import</span> <span class="p">(</span><span class="n">DefaultAzureCredential</span><span class="p">,</span>
                            <span class="n">InteractiveBrowserCredential</span><span class="p">,</span>
                            <span class="n">InteractiveBrowserCredential</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">azure.core.exceptions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ResourceExistsError</span><span class="p">,</span>
    <span class="n">HttpResponseError</span>
<span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">credential</span> <span class="o">=</span> <span class="n">DefaultAzureCredential</span><span class="p">()</span>
    <span class="n">credential</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="s2">&quot;https://management.azure.com/.default&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="n">credential</span> <span class="o">=</span> <span class="n">InteractiveBrowserCredential</span><span class="p">()</span>

<span class="n">workspace_ml_client</span> <span class="o">=</span> <span class="n">MLClient</span><span class="p">(</span>
    <span class="n">credential</span><span class="p">,</span>
    <span class="n">subscription_id</span><span class="o">=</span><span class="s2">&quot;77e0e886-66a0-48ff-be94-66a9737fac63&quot;</span><span class="p">,</span>
    <span class="n">resource_group_name</span><span class="o">=</span><span class="s2">&quot;adnegrau-workshop&quot;</span><span class="p">,</span>
    <span class="n">workspace_name</span><span class="o">=</span><span class="s2">&quot;adnegrau-workshop&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Pick a model to deploy</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_registry_name</span> <span class="o">=</span> <span class="s2">&quot;azureml&quot;</span> <span class="c1"># all the models in the model catalog</span>
<span class="n">registry_ml_client</span> <span class="o">=</span> <span class="n">MLClient</span><span class="p">(</span><span class="n">credential</span><span class="p">,</span> <span class="n">registry_name</span><span class="o">=</span><span class="n">model_registry_name</span><span class="p">)</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">registry_ml_client</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">list</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mistralai-Mixtral-8x7B-Instruct-v01
OpenAI-CLIP-Image-Text-Embeddings-ViT-Large-Patch14-336
playground-ayod-rag
deci-decidiffusion-v1-0
Deci-DeciLM-7B-instruct
Deci-DeciLM-7B
Deci-DeciCoder-1b
mistralai-Mixtral-8x7B-v01
mmd-3x-yolof_r50_c5_8x8_1x_coco
mmd-3x-vfnet_x101-64x4d-mdconv-c3-c5_fpn_ms-2x_coco
mmd-3x-vfnet_r50-mdconv-c3-c5_fpn_ms-2x_coco
mmd-3x-sparse-rcnn_r50_fpn_300-proposals_crop-ms-480-800-3x_coco
mmd-3x-sparse-rcnn_r101_fpn_300-proposals_crop-ms-480-800-3x_coco
mmd-3x-mask-rcnn_swin-t-p4-w7_fpn_1x_coco
mmd-3x-deformable-detr_refine_twostage_r50_16xb2-50e_coco
microsoft-Orca-2-7b
microsoft-Orca-2-13b
stabilityai-stable-diffusion-xl-refiner-1-0
AutoML-Image-Object-Detection
AutoML-Image-Instance-Segmentation
AutoML-Image-Classification
mmeft
ocsort_yolox_x_crowdhuman_mot17-private-half
bytetrack_yolox_x_crowdhuman_mot17-private-half
mistralai-Mistral-7B-v01
mistralai-Mistral-7B-Instruct-v01
facebook-sam-vit-large
facebook-sam-vit-huge
facebook-sam-vit-base
openai-whisper-large-v3
qna-rag-metrics-eval
qna-non-rag-metrics-eval
Salesforce-BLIP-vqa-base
Salesforce-BLIP-image-captioning-base
Salesforce-BLIP-2-opt-2-7b-vqa
Salesforce-BLIP-2-opt-2-7b-image-to-text
openai-clip-vit-large-patch14
OpenAI-CLIP-Image-Text-Embeddings-vit-base-patch32
openai-clip-vit-base-patch32
stabilityai-stable-diffusion-2-inpainting
stabilityai-stable-diffusion-2-1
runwayml-stable-diffusion-v1-5
runwayml-stable-diffusion-inpainting
compvis-stable-diffusion-v1-4
web-classification
template-standard-flow
template-eval-flow
template-chat-flow
qna-with-your-own-data-using-faiss-index
qna-relevance-eval
qna-groundedness-eval
qna-gpt-similarity-eval
qna-fluency-eval
qna-f1-score-eval
qna-coherence-eval
qna-ada-similarity-eval
how-to-use-functions-with-GPT-chat-API
classification-accuracy-eval
chat-with-wikipedia
bring-your-own-data-chat-qna
ask-wikipedia
tiiuae-falcon-40b
bring-your-own-data-qna
deformable_detr_twostage_refine_r50_16x2_50e_coco
sparse_rcnn_r50_fpn_300_proposals_crop_mstrain_480-800_3x_coco
vfnet_x101_64x4d_fpn_mdconv_c3-c5_mstrain_2x_coco
mask_rcnn_swin-t-p4-w7_fpn_1x_coco
sparse_rcnn_r101_fpn_300_proposals_crop_mstrain_480-800_3x_coco
yolof_r50_c5_8x8_1x_coco
microsoft-beit-base-patch16-224-pt22k-ft22k
google-vit-base-patch16-224
microsoft-swinv2-base-patch4-window12-192-22k
vfnet_r50_fpn_mdconv_c3-c5_mstrain_2x_coco
facebook-deit-base-patch16-224
tiiuae-falcon-7b
databricks-dolly-v2-12b
bert-base-cased
deepset-minilm-uncased-squad2
roberta-large-openai-detector
openai-whisper-large
sshleifer-distilbart-cnn-12-6
distilroberta-base
roberta-base
finiteautomata-bertweet-base-sentiment-analysis
facebook-bart-large-cnn
distilbert-base-cased
t5-base
roberta-large
bert-large-uncased
deepset-roberta-base-squad2
distilbert-base-uncased-distilled-squad
distilbert-base-uncased
microsoft-deberta-base-mnli
bert-large-cased
distilbert-base-uncased-finetuned-sst-2-english
t5-small
gpt2-medium
microsoft-deberta-large-mnli
gpt2-large
Jean-Baptiste-camembert-ner
roberta-large-mnli
distilbert-base-cased-distilled-squad
bert-base-uncased
microsoft-deberta-large
t5-large
camembert-base
microsoft-deberta-xlarge
roberta-base-openai-detector
gpt2
distilgpt2
microsoft-deberta-base
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Get the model you want</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for Model attributes e.g. Version</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s2">&quot;microsoft/phi-2&quot;</span> <span class="c1">#&quot;mistralai-Mistral-7B-Instruct-v01&quot; </span>
<span class="n">model_versions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">registry_ml_client</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">model_name</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of versions: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_versions</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All versions: &quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">version</span><span class="o">.</span><span class="n">version</span> <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">model_versions</span><span class="p">])</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_versions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model not found in registry&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">model_version</span> <span class="o">=</span> <span class="n">model_versions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">version</span>
    <span class="n">foundation_model</span> <span class="o">=</span> <span class="n">registry_ml_client</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">model_version</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Using model name: </span><span class="si">{0}</span><span class="s2">, version: </span><span class="si">{1}</span><span class="s2">, id: </span><span class="si">{2}</span><span class="s2"> for inferencing&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">foundation_model</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">foundation_model</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">foundation_model</span><span class="o">.</span><span class="n">id</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of versions:  0
All versions:  []
Model not found in registry
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="4">
<li><p>Deploy the model to an online endpoint</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azure.ai.ml.entities</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ManagedOnlineEndpoint</span><span class="p">,</span>
    <span class="n">ManagedOnlineDeployment</span><span class="p">,</span>
    <span class="n">OnlineRequestSettings</span>
<span class="p">)</span>

<span class="c1"># Names need to be unique in a region (use timestamp in the name)</span>
<span class="n">online_endpoint_name</span> <span class="o">=</span> <span class="s2">&quot;adnegrau-mistral-7B&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="n">ManagedOnlineEndpoint</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">online_endpoint_name</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Online endpoint Mistral 7B&quot;</span><span class="p">,</span>
        <span class="n">auth_mode</span> <span class="o">=</span> <span class="s2">&quot;key&quot;</span>
    <span class="p">)</span>
    <span class="n">workspace_ml_client</span><span class="o">.</span><span class="n">begin_create_or_update</span><span class="p">(</span><span class="n">endpoint</span><span class="p">)</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="k">except</span> <span class="n">HttpResponseError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">409</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Endpoint already exists. Skipping creation.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">e</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Endpoint name is invalid. Skipping creation.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occured: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occured: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="markdown.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Markdown Files</p>
      </div>
    </a>
    <a class="right-next"
       href="markdown-notebooks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Notebooks with MyST Markdown</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#markdown-notebooks">Markdown + notebooks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#myst-markdown">MyST markdown</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-blocks-and-outputs">Code blocks and outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-phi2-from-aml">Use phi2 from AML</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Raouf Aliouat & Adina Stoll
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>